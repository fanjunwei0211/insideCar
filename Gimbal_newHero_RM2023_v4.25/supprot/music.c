#include "music.h"
#include "main.h"
#include "bsp_buzzer.h"
#include "delay.h"

#include "FreeRTOS.h"
#include "task.h"//延时用任务延时vTaskDelay

 
/**
  ******************************************************************************
  * @file    music.c
  * @brief   
  ******************************************************************************
		数组位置			音符		频率/Hz				数组位置			音符		频率/Hz				数组位置			音符		频率/Hz
		1+10=11			低音1			262						 1				中音1			523					1+20=21 		高音1			1046
	 1+10+30=41		低音1#		277					1+30=31			中音1#		554			   1+20+30=51		高音1#		1109
		2+10=12			低音2			294					   2				中音2			587					2+20=22			高音2			1175
	 2+10+30=42		低音2#		311					2+30=32			中音2#		622				 2+20+30=52	 	高音2#		1245
		3+10=13			低音3			330					   3				中音3			659					3+20=33			高音3			1318
		4+10=14			低音4			349					   4				中音4			698					4+20=44			高音4			1397
	 4+10+30=44		低音4#		370					4+30=34			中音4#		740				 4+20+30=54		高音4#		1480
		5+10=15			低音5			392					   5				中音5			784					5+20=25			高音5			1568
	 5+10+30=45		低音5#		415					5+30=35 		中音5#		831				 5+20+30=55	 	高音5#		1661
		6+10=16			低音6			440					   6				中音6			880					6+20=26			高音6			1760
	 6+10+30=46	 	低音6#		466					6+30=36			中音6#		932				 6+20+30=56		高音6#		1965
		7+10=17			低音7			494					   7				中音7			988					7+20=27			高音7			1976
  ******************************************************************************
*/

#define ARRAY_LEN(a) (sizeof(a)/sizeof(a[0])) // 获取数组a的长度
	
uint16_t unit_time=100; // 单位时间（ms），大小得看谱子上标的，一分钟要演奏多少拍

/**
  * @brief          基本的音调，即声音频率，包括“哆来咪发唆拉西哆”及其高低音
										为了避免出现除数为0的bug，，0统一加1
  */
/****************		0						1					2					3					4					5					6					7				8				9			****/
uint16_t tone[]={	
/****************							中音1			中音2			中音3 		中音4 		中音5			中音6			中音7	 								****/
										0+1,			 523,			 587,			 659, 		 698,  		784, 	 		 880,   	 988,   	0+1,    0+1,
/****************							低音1			低音2			低音3 		低音4 		低音5			低音6			低音7									****/
										0+1,  		 262,		   294,  		 330, 		 349,  		392, 	 		 440,  		 494,   	0+1,    0+1,
/****************							高音1			高音2			高音3 		高音4 		高音5			高音6			高音7	 								****/
										0+1, 		  1046,		  1175, 		1318, 		1397, 		1568, 		 1760, 		1976, 		0+1,    0+1,
/****************							中音1#		中音2#		中音3#		中音4#		中音5#		中音6#	       									****/	
										0+1,  		 554, 		 622,  	  0+1,  		 740,  		831,  	 	 932,  		 0+1,  		0+1,    0+1,
/****************							低音1#		低音2#		低音3#		低音4#		低音5#		低音6#	       									****/	
										0+1,  		 277, 		 311,  	  0+1, 	 			370, 	 	415,  		 466,    	 0+1,     0+1,    0+1,
/****************							高音1#		高音2#		高音3#		高音4#		高音5#		高音6#	       									****/	
								    0+1, 		  1109, 		1245,  	  0+1,  		 1480, 		1661, 		 1965,     0+1,     0+1,    0+1 
								 
								};

/**[1.1]
  * @brief          某个乐曲中的音调列表
  */
/***********我也不知道什么歌**************/								
//uint8_t music[]=
//{
//5,5,6,8,7,6,5,6,13,13,
//	5,5,6,8,7,6,5,3,13,13,
//	2,2,3,5,3,5,6,3,2,1,
//	6,6,5,6,5,3,6,5,13,13,
//	
//	5,5,6,8,7,6,5,6,13,13,
//	5,5,6,8,7,6,5,3,13,13,
//	2,2,3,5,3,5,6,3,2,1,
//	6,6,5,6,5,3,6,1,
//	
//	13,8,9,10,10,9,8,10,9,8,6,
//	13,6,8,9,9,8,6,9,8,6,5,
//	13,2,3,5,5,3,5,5,6,8,7,6,
//	6,10,9,9,8,6,5,6,8
//};

/**[1.2]
  * @brief          节拍，也就是持续时间，“2”表示某音调的持续时间为2个基本时间单位unit_time
  */
/***********我也不知道什么歌**************/		
//uint8_t time[]=
//{
//2,4,2,2,2,2,2,8,4,4,
//	2,4,2,2,2,2,2,8,4,4,
//	2,4,2,4,2,2,4,2,2,8,
//	2,4,2,2,2,2,2,8,4,4,
//	
//	2,4,2,2,2,2,2,8,4,4,
//	2,4,2,2,2,2,2,8,4,4,
//	2,4,2,4,2,2,4,2,2,8,
//	2,4,2,2,2,2,2,8,
//	
//	4,2,2,2,4,2,2,2,2,2,8,
//	4,2,2,2,4,2,2,2,2,2,8,
//	4,2,2,2,4,2,2,5,2,6,2,4,
//	2,2,2,4,2,4,2,2,12
//};

///**[2.1]
//  * @brief          《天空之城》的音调列表
//  */
///***********天空之城**************/		
//uint8_t music[]=
//{
//	/*************/
//	6+10,7+10,
//	/*************/
//	1,7+10,1,3,
//	7+10,3+10,
//	6+10,5+10,6+10,1,
//	5+10,3+10,
//	4+10,3+10,4+10,1,
//	/*************/
//	3+10,1,
//	7+10,4+10+30,4+10+30,7+10,
//	7+10,0,6+10,7+10,
//	1,7+10,1,3,
//	7+10,3+10,
//	/*************/
//	6+10,5+10,6+10,1,
//	5+10,3+10,
//	4+10,1,7+10,1,
//	2,3,1,0,
//	1,7+10,6+10,7+10,5+10+30,
//	/*************/
//	6+10,0,1,2,
//	3,2,3,4,5,
//	2,5+10,
//	2,1,7+10,1,2,3,
//	/*************/
//	3,
//	6+10,7+10,1,7+10,1,2,
//	1,5+10,
//	4,3,2,1,
//	3,6+10,7+10,
//	1,7+10,1,3,
//	/*************/
//	7+10,3+10,
//	6+10,5+10,6+10,1,
//	5+10,3+10,
//	4+10,1,7+10,1,
//	2,3,1,
//	/*************/
//	1,7+10,6+10,7+10,5+10+30,
//	/*************/
//	6+10
//};
///**[2.2]
//  * @brief          节拍，也就是持续时间，“2”表示某音调的持续时间为2个基本时间单位unit_time
//  */
///***********天空之城**************/		
//uint8_t time[]=
//{
//	/*************/
//	2,2,
//	/*************/
//	4+2,2,4,4,
//	4+4+4,4,
//	4+2,2,4,4,
//	4+4+4,4,
//	4+2,2,2,2+4,
//	/*************/
//	4+4+4,4,
//	4+2,2,4,4,
//	4+4,4,2,2,
//	4+2,2,4,4,
//	4+4+4,2+2,
//	/*************/
//	4+2,2,4,4,
//	4+4+4,4,
//	4,2,2+4,4,
//	4,2,4+4,2,
//	2,2,4,4,4,
//	/*************/
//	4+4,4,2,2,
//	4+2,3,3,3,2,
//	4+4+4,4,
//	1,1,1,1+4+2,4,2,
//	/*************/
//	4+4+4+4,
//	2,2,4,2,2,4,
//	4+2,2,4+4,
//	4,4,4,4,
//	4+4+4,2,2,
//	4+2,2,4,4,
//	/*************/
//	4+4+4,4,
//	4+2,2,4,4,
//	4+4+4,4,
//	4,2,2+4,4,
//	4,2,2+4+4,
//	/*************/
//	2,2,4,4,4,
//	4+4+4+4
//};



///**[3.1]
//  * @brief          《新闻联播》的音调列表
//  */
///***********新闻联播**************/		
//uint8_t music[]=
//{
//	/*************/
//	5+10,
//	1,5+10,3,1,
//	5,
//	1+20,7,6,
//	3,
//	/*************/
//	1,1,3,2,
//	6+10,
//	2,2,3,2,
//	6,3,
//	/*************/
//	5,
//	5+10,6+10,
//	1,
//	/*************/
//	0
//};
///**[3.2]
//  * @brief          节拍，也就是持续时间，“2”表示某音调的持续时间为2个基本时间单位unit_time
//  */
///***********新闻联播**************/		
//uint8_t time[]=
//{
//	/*************/
//	2,
//	2,2,2,2,
//	4+4,
//	4,2,2,
//	4+4,
//	/*************/
//	2,2,2,2,
//	4+4,
//	2,2,2,2,
//	4,4,
//	/*************/
//	4+4+4,
//	2,2,
//	4+4+4+4+4+2,
//	/*************/
//	2
//};

///**[4.1]
//  * @brief          《喜羊羊》的音调列表
//  */
///***********喜羊羊**************/		
//uint8_t music[]=
//{
//	/*************/
//	0,3+20,3+20,3+20,3+20,2+20,1+20,6,
//	4,2+20,
//	0,7,7,7,7,1+20,2+20,
//	/*************/
//	1+20,0,
//	3,5,5,0,2,5,5,
//	0,3,5,5,2,5,5,
//	/*************/
//	
//};
///**[4.2]
//  * @brief          节拍，也就是持续时间，“2”表示某音调的持续时间为2个基本时间单位unit_time
//  */
///***********喜羊羊**************/		
//uint8_t time[]=
//{
//	/*************/
//	2,2,2,2,2,2,2,2,
//	4,4+4+4,
//	2,2,2,2,2,2,4,
//	/*************/
//	4+4+4,2,
//	4,2,2,2,2,2,2,
//	2,2,2,2,4,2,2
//	/*************/

//	/*************/
//	
//};

///**[5.1]
//  * @brief          《猫和老鼠》的音调列表
//  */									寄了
///***********猫和老鼠**************/		
//uint8_t music[]=
//{
//	/******第一行*******/
//	6+30,7,1+20,1+20+30,2+20,
//	5,5,5,0,7,1+20,1+20+30,2+20+30,2+20+30,
//	5+30,5,5,0,
//	/******第二行*******/
//	7,6+30,6+30,5+30,
//	1+20,2+20,6,1+20,2+20,6+20,2+20,
//	4,6,4,4,2+30,3,
//	3,5,3,3,3,4,
//	/******第三行*******/
//	6,6+30,1+20,2+20,1+20,4+20,2+20,4+20,
//	5,4+20,5+20,0,5,6+30,
//	/******第四行*******/
//	4,6,4,4,4,
//	6,1+20,6,6,6,6,6,
//	3+20,4+20+30,2+20,3+20,1+20+30,2+20,7,1+20,
//	/*****第五行********/
//	6,5+30,6,0,1+20,7+10,1,2,2+30,3,4,
//	4,2+20,6,1,0,
//	6+30,1+20,5,2,7,1+20,
//	1,6+10,
//	
//};
///**[5.2]
//  * @brief          节拍，也就是持续时间，“2”表示某音调的持续时间为2个基本时间单位unit_time
//  */								寄了
///***********猫和老鼠**************/		
//uint8_t time[]=
//{
//	/******第一行*******/	
//	1,1,1,1,1,
//	3,1,2,2,1,1,1,1,1,
//	3,1,2,2,
//	/******第二行*******/
//	4,4,4,4,
//	2,2,2,4,2,2,2,
//	2,2,2,4,4,2,
//	2,2,2,4,4,2,
//	/******第三行*******/
//	2,2,2,2,2,2,2,2,
//	3,1,1,1,4+2,4,
//	/******第四行*******/
//	2,2,2,4,4+2,
//	2,2,2,4,2,2,2,
//	2,2,1,2,3,2,2,2,
//	/*****第五行********/
//	3,1,1,1,4+2,1,1,1,1,1,1,
//	2,2,2,4,4,
//	2,2,2,4,2,4,
//	4+4,4+4
//	
//	
//};


///***********加州旅馆**************/	
//uint8_t music[]=
//{
//	/*************************第一部分第一段****************************/
///************第一页***********/
//	/******第一行*******/
//	3+20,1+20,6,3+20,1+20,
//	6,1+20,2+20,
//	5+30,2+20,3+20,3,7+20,2+20,3+20,
//	5+30,
//	5,2+20,2+20,5+20,6+20,5+20,
//	/******第二行*******/
//	5,2+20,5,2,2+20,3+20,
//	4+30,6,1+20,6,3+20,1+20,
//	6+20,
//	4+20,6,1+20,6,4+20,6,1+20,
//	6+20,4,4+20,5,6,1+20,
//	/******第三行*******/
//	5+20,1+20,3+20,1,1+20,5,3+20,
//	3,1+20,3+20,1,5,3+20,
//	2,6,1+20,6,4+20,6,4+20,
//	6+20,6,1+20,6,6,3+20,
//	/******第四行*******/
//	3,5+30,2+20,2+20,3+20,5,2+20,
//	7+20,
//	0,3+20,3+20,3+20,2+20,2+20,
//	2+20,3+20,0,0,
//	/******第五行*******/
//	0,3+20,3+20,2+20,2+20,
//	2+20,0,0,
//	0,2+20,3+20,3+20,2+20,2+20,
//	/******第六行*******/
//	2+20,2+20,3+20,0,0,
//	0,3+20,3+20,3+20,2+20,2+20,
//	2+20,1+20,6,0,0,
//	/******第七行*******/
//	0,3+20,3+20,3+20,2+20,1+20,
//	1+20,3+20,0,0,
//	0,1+20,3+20,3+20,3+20,3+20,2+20,1+20,
///************第二页***********/
//	/******第一行*******/
//	1+20,0,0,0,
//	0,2,2+20,2+20,2+20,2+20,2+20,1+20,
//	2+20,1+20,3+20,3+20,0,
//	/******第二行*******/
//	0,3,3+20,3+20,3+20,2+20,2+20,
//	2+20,3+20,0,0,
//	0,3+20,3+20,4+20,3+20,3+20,
//	/******第三行*******/
//	4+20,3+20,0,0,
//	0,3,3+20,3+20,3+20,2+20,2+20,
//	2+20,0,0,0,0,//原谱是×，这里改成零
//	/******第四行*******/
//	0,0,2,2+20,2+20,2+20,1+20,
//	2+20,2+20,3+20,3+20,3+20,3+20,3+20,
//	3+20,3+20,3+20,3+20,2+20,2+20,
//	/******第五行*******/
//	2+20,1+20,6,0,0,
//	0,3+20,3+20,3+20,2+20,2+20,
//	1+20,3+20,0,0,
//	/******第六行*******/
//	0,6,1+20,3+20,2+20,1+20,
//	1+20,6,5,0,0,
//	0,2+20,2+20,2+20,2+20,2+20,1+20,
//	/******第七行*******/
//	2+20,1+20,3+20,3+20,0,
//	0,2+20,3+20,3+20,3+20,5+20,
//	3+20,2+20,0,0,
///************第三页***********/
//	/******第一行*******/
//	0,4+20,4+20,4+20,4+20,4+20,4+20,
//	4+20,4+20,5+20,4+20,4+20,
//	4+20,3+20,0,0,
//	0,0,0,3+20,3+20,
//	/******第二行*******/
//	3+20,2+20,2+20,2+20,2+20,3+20,3+20,
//	3+20,2+20,2+20,2+20,2+20,2+20,2+20,
//	2+20,1+20,1+20,1+20,1+20,0,
//	/******第三行*******/
//	0,0,0,0,1+20,
//	4+20,4+20,4+20,4+20,4+20,4+20,4+20,
//	4+20,4+20,5+20,4+20,4+20,
//	4+20,3+20,0,0,
//	/******第四行*******/
//	0,0,0,3+20,3+20,
//  3+20,2+20,2+20,2+20,2+20,2+20,3+20,
//	3+20,2+20,2+20,2+20,2+20,3+20,4+20,
//	/******第五行*******/
//	4+20,3+20,3+20,3+20,3+20,0,
//	0,0,0,0,
////篇幅原因第一部分第二段和第二部分第二段不写了
///*************************第二部分第二段****************************/	
//	/******第六行*******/
//	0,3+20,3+20,3+20,4+20,3+20,
//	4+20,2+20,3+20,3+20,0,
//	0,3,3+20,3+20,3+20,3+20,2+20,
//	/******第七行*******/
//	2+20,3+20,0,0,0,0,//原谱是×，这里改成零
//	0,3+20,2+20,2+20,2+20,2+20,2+20,
//	3+20,2+20,2+20,2+20,3+20,0,
//	/******第八行*******/
//	0,3+20,3+20,3+20,2+20,1+20,
//	1+20,0,0,0,
//	0,4,3+20,3+20,3+20,2+20,1+20,
//	/************第四页***********/
//	/******第一行*******/
//	1+20,2+20,3+20,3+20,0,
//	0,3,3+20,2+20,2+20,1+20,
//	1+20,0,0,0,
//	0,2,2+20,2+20,2+20,2+20,1+20,
//	/******第二行*******/
//	2+20,1+20,3+20,3+20,2+20,1+20,
//	3+20,3+20,3+20,3+20,2+20,
//	3+20,0,0,0,
//};
///***********加州旅馆**************/		
//uint8_t time[]=
//{
///************第一页***********/
//	/******第一行*******/
//	4,2,2,4,2,
//	4+4,4,4,
//	4,2,2,2,2,2,2,
//	4+4+4+4,
//	4,2,2,2,4,2,
//	/******第二行*******/	
//	4,2,2,4,2,2,
//	4,2,2,2,4,2,
//	4+4+4+4,
//	4,2,2,2,2,2,2,
//	4,2,2,2,2,4,
//	/******第三行*******/	
//	4,2,2,2,2,2,2,
//	4,2,2,4,2,2,
//	4,2,2,2,2,2,2,
//	4,2,2,4,2,2,
//	/******第四行*******/
//	4,2,2,2,2,2,2,
//	4+4+4+4,
//	4,2,2,4,2,2,
//	4,4,4,4,
//	/******第五行*******/
//	4,4,4,4,4,
//	4+4,4,4,
//	4,2,2,4,2,2,
//	/******第六行*******/
//	4,2,2,4,4,
//	4,4,4,4,4,4,
//	2,2,4,4,4,
//	/******第七行*******/
//	4,2,2,4,2,2,
//	4,4,4,4,
//	2,2,2,2,4,4,4,
///************第二页***********/
//	/******第一行*******/
//	4,4,4,4,
//	2,2,2,2,2,2,2,2,
//	4,2,2,4,4,
//	/******第二行*******/
//	2,2,2,2,4,4,4,
//	2,4+2,4,4,
//	4,2,2,4,2,2,
//	/******第三行*******/
//	4,4,4,4,
//	2,2,2,2,4,4,4,
//	4,4,2,2,4,
//	/******第四行*******/
//	4,2,2,2,2,2,2,
//	2,4,2,2,2,2,2,
//	/******第五行*******/
//	2,2,4,4,4,
//	4,2,2,4,4,4,
//	4,4,4,4,
//	/******第六行*******/
//	4,2,2,4,2,2,
//	2,2,4,4,4,
//	4,2,2,2,2,2,2,
//	/******第七行*******/
//	4,2,2,4,4,
//	2,2,2,2,4,4,
//	2,4+2,4,4,
///************第三页***********/
//	/******第一行*******/
//	4,2,2,2,2,2,2,
//	2,4+2,4,2,2,
//	2,4+2,4,4,
//	4,4,4,2,2,
//	/******第二行*******/
//	2,2,2,2,4,2,2,
//	2,2,2,2,4,2,2,
//	2,2,2,2,4,4,
//	/******第三行*******/
//	4,4,4,2,2,
//	2,2,2,2,2,4,2,
//	4,4,4,2,2,
//	2,4+2,4,4,
//	/******第四行*******/
//	4,4,4,2,2,
//	2,2,2,2,4,2,2,
//	2,2,2,2,4,2,2,
//	/******第五行*******/
//	2,2,2,2,4,4,
//	4,4,4,4,
//	/******第六行*******/
//	4,2,2,2,4,2,
//	4,2,2,4,4,
//	2,2,2,2,4,4,4,
//	/******第七行*******/
//	2,2,2,2,4,4,
//	4,2,2,2,2,2,2,
//	4,4,4,2,2,4,
//	/******第八行*******/
//	4,2,2,2,4,2,
//	4,4,4,4,
//	2,2,2,2,4,2,2,
//	/************第四页***********/
//	/******第一行*******/
//	4,2,2,4,4,
//	4,4,4,4,4,4,
//	4,4,4,4,
//	2,2,2,2,4,4,4,
//	/******第二行*******/
//	2,4,2,4,2,2,
//	4,4,2,4,2,
//	4,4,4,4,

//};


/**[5.1]
  * @brief          《少年英雄小哪吒》的音调列表
  */									
/***********少年英雄小哪吒**************/		
uint8_t music[]=
{
	/******第一行*******/
	3,1+20,1+20,0,0,3,7,
	3,7,7,0,7,3,6,
	6,5,3,2,1,2,
	3,5,6,6,0,
	/******第二行*******/
	3,1+20,0,2+20,1+20,7,
	3,7,0,1+20,7,6,
	6,3,2,3,
	5,1+20,6,6,0,
	/******第三行*******/
	3+20,3+20,3+20,6,
	4+20,3+20,2+20,2+20,
	2+20,2+20,2+20,5,
	1+20,2+20,3+20,3+20,
	3+20,3+20,3+20,6,1+20,
	/******第四行*******/
	4+20,3+20,2+20,2+20,
	2+20,2+20,2+20,5,1+20,2+20,
	1+20,7,6,6,0,
	3+20,1+20,1+20,2+20,1+20,7,
	/*****第五行********/
	3,7,7,1+20,7,6,
	6,5,3,2,1,1,2,
	3,5,6,6,
	3,1+20,1+20,2+20,1+20,7,
	/*****第六行********/
	3,7,7,1+20,7,6,
	6,5,3,2,3,3,3,
	5,0,6,0,
	6
};
/**[5.2]
  * @brief          节拍，也就是持续时间，“2”表示某音调的持续时间为2个基本时间单位unit_time（寄了）
  */								
/***********少年英雄小哪吒**************/		
uint8_t time[]=
{
	/******第一行*******/
	2,2,2,2,2,2,4,
	2,2,2,2,3,1,4,
	3,1,2,2,4+2,2,
	4,2,2,4,4,
	/******第二行*******/
	2,4,2,2,2,4,
	2,4,2,3,1,4,
	4,2,2,4+4,
	4,2,2,4,4,
	/******第三行*******/
	2,2,4,4+4,
	4,2,2,4+4,
	3,1,4,4+4,
	4,2,2,4+4,
	3,1,4,4+2,2,
	/******第四行*******/
	4,2,2,4+2,
	3,1,4,4,2,2,
	4,2,2,4,4,
	2,4,2,2,2,4,
	/*****第五行********/
	2,4,2,2,2,4,
	3,1,2,2,4,2,2,
	4,2,2,4+4,
	2,4,2,2,2,4,
	/*****第六行********/
	2,4,2,2,2,4,
	3,1,2,2,4,2,2,
	4,4,4,4,
	4+4+4+4,
	
};


/**
  * @brief          使用user_delay_us函数延迟一段时间
  * @param[in]      frq:frq频率
  * @retval         none
  */
void Sound(uint16_t frq)
{
	uint16_t psc;
	uint16_t arr;
	uint16_t ccr;
	
	psc=83;//TIM4属于通用定时器，挂在APB1低速时钟线，84MHz，分频后频率：84M/（psc+1）=84M/（83+1）=1M Hz
	arr=(uint16_t)(1000000/frq);//PWM的频率（声音频率）:frq=84M/(psc+1)/(arr+1)=1M/(arr+1);近似就arr=1M/frq,知道频率反算重载值
	ccr=(uint16_t)(15000/frq);//PWM的占空比（声音响度），占空比=（ccr-1）/arr，人耳听着舒服就从千分之一到千分之十区间
	
	if(frq!=1)		//这个1就是tone[]数组的“0+1”，就判断是不是0音符
	{
		buzzer_on(psc,arr,ccr);

	}
	else			
	{
		
     buzzer_off();			//0音符表示没声音
		
	}
	
}

/**
  * @brief          演奏音乐
  * @param[in]      none
  * @retval         none
  */
void play(void)
{

	uint16_t i;

	for(i=0;i<ARRAY_LEN(music);i++)
//	for(i=0;i<5;i++)
	{
		
		Sound((uint16_t)tone[music[i]]);
		
//	user_delay_ms(time[i]*unit_time);
		vTaskDelay(time[i]*unit_time);//在任务里面还是用任务延时函数
		
		/*两个音符之间歇一会儿*/
		buzzer_off();
		
//		user_delay_ms(unit_time);
		vTaskDelay(0.3*unit_time);
	}
	
	buzzer_off();
	
//	user_delay_ms(10000);
	vTaskDelay(10000);
}
